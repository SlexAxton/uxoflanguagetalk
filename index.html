<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>The UX of Language | Alex Sexton | jQueryCon SF 2012</title>

    <meta name="description" content="There are 1 thing(s) that you have probably noticed about
    l10n and I18n in your JavaScript App(s). The sentences, even in english, are as ridiculous as
    the first one in this paragraph. Sure, you may be used to it, but it's a crappy user experience.
    There's lots you can do to make your data driven sentences valid, even expressive, in your
    language, and then expand that to any language. This talk will round up a set of tools and
    techniques to help prepare you to write apps that don't sound like Borat.">
    <meta name="author" content="Alex Sexton">

    <link href='css/fonts.css' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/print.css" type="text/css" media="print">

    <link rel="stylesheet" href="lib/zenburn.css">
    <script src="js/messageformat.js"></script>
    <style type="text/css">
      body .reveal .slides {
        width : 1280px;
        margin-left : -640px;
      }
      .reveal pre code {
        font-size : 34px;
        line-height : 38px;
      }
      .reveal pre.thin {
        width: 67%;
      }
      .reveal .oneliner {
        padding-top : 12%;
        font-size : 1.4em;
      }
      .reveal .oneliner h3 {
        line-height: 1;
      }
      .reveal .tall {
        margin-top: -60px;
      }
      body .reveal em {
        font-style : normal;
        font-size : 1.2em;
        color : #A6E22E;
      }
      body .reveal .oneliner em {
        text-transform : uppercase;
        font-weight : bold;
      }
      .reveal aside.notes {
        display: none;
      }
    </style>
  </head>

  <body>

    <div class="reveal">

      <!-- Used to fade in a background when a specific slide state is reached -->
      <div class="state-background"></div>

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <section data-markdown class="oneliner">
          # The *UX* of Language

          <br />

          ### It are very importants.

          <script>
            // Delicously hacky. Look away.
          if( navigator.userAgent.match( /(iPhone|iPad|iPod|Android)/i ) ) document.write( '<p style="color: rgba(0,0,0,0.3); text-shadow: none;">('+'Tap to navigate'+')</p>' );
          </script>

          <aside class="notes">
            Notes for slide 1
          </aside>
        </section>

        <section>
          <section data-markdown class="oneliner">
            # *Briefly*

            <aside class="notes">
              Notes for slide 2
            </aside>
          </section>

          <section data-markdown class="oneliner">
            There's a lot of pressure for
            someone who is talking on
            *The UX of Language*
            to speak eloquently.

            <aside class="notes">
              Notes for slide 2b
            </aside>
          </section>

          <section data-markdown class="oneliner">
            There is also often a misconception that
            I can speak multiple languages.

            &nbsp;

            <small>I assure you</small>

            &nbsp;

            *No Conozco Pantelones Verdes*

            <aside class="notes">
              Notes for slide 2c
            </aside>
          </section>

          <section data-markdown class="oneliner">
            Let's call me an
            *enabler*
            of those people who can speak
            with grace and restraint.

            *;)*
          </section>
        </section>

        <section>
          <section data-markdown>
            ## Thing(s) about *Alex*

            <img src="img/alexsexton.jpg" alt="alex sexton" style="width:25%;" />
          </section>
          <section data-markdown class="oneliner">
            I *like* to build JavaScript programs
          </section>
          <section data-markdown class="oneliner">
            My mom was an english teacher

            &nbsp;

            <small>(I think)</small>
          </section>
          <section data-markdown class="oneliner">
            8 inch vertical jump

            &nbsp;

            *Bench* 115 lbs

            *Squat* 250 lbs
          </section>
        </section>

        <section>
          <section>
            <img src="img/thegdb_quote.jpg" alt="Tweet: Web programming is the science of coming up with increasingly complicated ways of concatenating strings."
            style="margin-top:80px;box-shadow:0 0 30px #222; width:60%;" />

            <aside class="notes">
              Greg Brockman wrote on Dec 17, 2011
              <br />
              I like this
            </aside>
          </section>

          <section data-markdown class="oneliner">
            # A Brief History of
            # *String Concatenation*
          </section>

          <section data-markdown class="tall">
            # 1986

            <img src="img/1986.png" style="box-shadow:0 0 30px #333333;" />

            &nbsp;
            Static text files ruled the web.
          </section>

          <section data-markdown class="oneliner">
            # Some time passes
          </section>

          <section data-markdown class="oneliner">
            People desire to
            *customize content*
            based on the person on the page
          </section>

          <section data-markdown class="oneliner">
            Enter the era of
            ## *Literally Just*
            ## *Outputting Strings*
          </section>

          <section data-markdown>
          # 1993 : CGI-BIN
          <pre><code contenteditable>#!/usr/bin/perl

print "Content-type:text/html\r\n\r\n";
print '&lt;html>';
print '&lt;head>';
print '&lt;title>Hello Word - First CGI Program&lt;/title>';
print '&lt;/head>';
print '&lt;body>';
print '&lt;h2>Hello Word! This is my 1st CGI app!&lt;/h2>';
print '&lt;/body>';
print '&lt;/html>';
&nbsp;
1;
</code></pre>
          </section>

          <section data-markdown class="oneliner">
            Enter the era of
            *Crappy Templates*
            that have enough logic to make things work.
          </section>

          <section data-markdown>
            # 1995

            <pre><code contenteditable>&lt;?php if ( isset($GET['USER'] ) { ?&gt;
                Welcome &lt;?= $GET['USER']; ?&gt;!
            &lt;?php
            }
            ?&gt;
            </code></pre>

            &nbsp;
            *PHP* (Personal Home Page) is released.

            <aside class="notes">
              JSP and ASP were no better.
            </aside>
          </section>

          <section data-markdown class="oneliner">
            Nearly 10 Years of
            ## *The String Concatenation*
            # *Dark Ages*
          </section>

          <section data-markdown>
            # 2004-Present

            <pre style="margin-top:100px;"><code contenteditable>var data = model.get('user');
            render(userTemplate(data));
            </code></pre>

            &nbsp;
            *MVC Frameworks* promote data/presentation decoupling

            &nbsp;
            *Logicless templates* come into popularity
          </section>

        </section>

        <section data-markdown class="oneliner">
          ## So we can finally render
          # *HTML*
        </section>

        <section data-markdown class="oneliner">
          ## What about rendering a sentence?
        </section>

        <section data-markdown>
          # A Templated Sentence

          <pre style="margin-top:100px;"><code contenteditable>// Handlebars template
          Welcome to the site, {{user_name}}!
          </code></pre>

          &nbsp;
          ## Seems *good*!
        </section>

        <section data-markdown class="oneliner">
          ## Let's try another.
        </section>

        <section data-markdown>
          # Another Templated Sentence

          <pre style="margin-top:100px;"><code contenteditable>// Handlebars template
          Hi {{user_name}}, you have {{msg_count}} new messages!
          </code></pre>

          &nbsp;
          ## Seems *good*?!?!
        </section>

        <section data-markdown class="oneliner">
          # *nope.*
        </section>

        <section>
          <section data-markdown class="oneliner">
            ## Hi *Alex*, you have *1* new messages!
          </section>

          <section data-markdown class="oneliner">
            ## *gross.*
          </section>

          <section data-markdown class="oneliner">
            # The *UX* of Language
          </section>
        </section>

        <section data-markdown class="oneliner">
          Our traditional way of concatenating
          strings together is *not sufficient*
          when those strings form a sentence.
        </section>

        <section data-markdown class="oneliner">
          ## *POLL*

          Do the visitors of your site care
          more about well-formed markup or
          well-formed sentences?

          <aside class="notes">
            How many of you optimize markup to output prettily
            and then output sentences like that?
          </aside>
        </section>

        <section data-markdown class="oneliner">
          ## We can do *better*
        </section>

        <section data-markdown class="oneliner">
          ## Consider the previous example

          *>* You have 2 new messages.
        </section>

        <section data-markdown class="oneliner">
          ## What about?

          You have X new message(s).

          Messages you have: 2

          <aside class="notes">
            The first one is uggers
            <br />
            The second one is 'prefix' or 'postfix' interpolation, and it sucks to read.
          </aside>
        </section>

        <section data-markdown class="oneliner">
          # lol*no*
        </section>

        <section data-markdown>
          ## Plural Branching

          &nbsp;

          <pre><code contenteditable>if (num === 1) {
            return 'You have 1 new message.';
          }
          else {
            return 'You have ' + num + ' new messages.';
          }
          </code></pre>
        </section>

        <section data-markdown class="oneliner">
          ## Let's add spanish...

          <aside class="notes">
            If you're saying "I don't need to i18n my app" - I'll
            get back to why this applies to you just as much.
          </aside>
        </section>

        <section data-markdown>
          <pre style="margin-top:-2%;"><code contenteditable>if (lang == 'en') {
          &nbsp; if (num === 1) {
              return 'You have 1 new message.';
            }
            else {
              return 'You have ' + num + ' new messages.';
            }
          }
          else if (lang == 'es') {
            if (num === 1) {
              // close enough
              return 'Tienes una message nueva.';
            }
            else {
              return 'Tienes ' + num + ' messages nuevas.';
            }
          }
          </code></pre>
        </section>

        <section data-markdown class="oneliner">
          ## Pretty ugly, and coupled
          ## directly into your _app_ code.
        </section>

        <section>
          <section data-markdown class="oneliner">
            ## *plus*
            ## consider these commonly
            ## supported languages
          </section>

          <section>
            <pre style="margin-top:-3%;"><code>
am  bn  cs  de  es  fa  fr  gsw hi  id  it kn
<br />
ln  mk  mr  nl  pl  ru  sl  sv  te  tr  vi ar
<br />
br  cy  el  et  fi  ga  gu  hr  in  iw  ko lt
<br />
ml  ms  no  pt  shi sq  sw  th  uk  zh  bg ca
<br />
da  en  eu  fil gl  he  hu  is  ja  lag lv mo
<br />
mt  or  ro  sk  sr  ta  tl  ur
            </code></pre>
          </section>

          <section data-markdown class="oneliner">
            <h2 style="margin-top:-5%;">Where's your</h2>

            ## *if-statement-pluralization*
            # *God*
            ## Now?!
          </section>


        </section>

        <section>
          <section data-markdown class="oneliner">
            ## I know what you're thinking
          </section>

          <section data-markdown class="oneliner">
            ## Richard Stallman hath fought
            ## the i18n ninjas and bestoweth
            ## *GNU Gettext* among us.
          </section>

          <section data-markdown class="oneliner">
            <div style="margin-top:2%;"></div>

            ![img/stallman.png](img/stallman.png)
          </section>

          <section data-markdown class="oneliner">
            ## I thought so too.

            <aside class="notes">
              But we'll get back to that.
            </aside>
          </section>
        </section>

        <section data-markdown class="oneliner">
          ## Navigating the
          ## *Message* Landscape
        </section>
        <section>
          <section data-markdown class="oneliner">
            # *properties files*
          </section>

          <section data-markdown class="oneliner">
            ## Usually just for i18n
            ### (if you can call it that)
          </section>

          <section data-markdown>
            ## Key Value Pairs

            <pre><code contenteditable>var properties_en = {
            &nbsp "button_text" : "Submit",
              "invalid_msg" : "Please try again."
            };
            &nbsp;
            var properties_es = {
              "button_text" : "Submitar",
              "invalid_msg" : "Por favor, trya againo"
            };
            </code></pre>
          </section>

          <section data-markdown>
            ## Use keys in templates instead of english

            &nbsp;

            <pre><code contenteditable>&lt;form&gt;
             &lt;input value="{{properties.button_text}}" name="s1" /&gt;
             &lt;span class="hidden"&gt;{{properties.invalid_msg}}&lt;span&gt;
            &lt;/form&gt;
            </code></pre>
          </section>

          <section data-markdown class="oneliner">
            ## *Common everywhere*
            ## (Java/Spring, Rails, etc)
          </section>

          <section data-markdown class="oneliner">
            ## Doesn't really address any of the hard
            ## problems except rendering different
            ## strings for different locales
          </section>

          <section data-markdown class="oneliner">
            ## Lot's of time they'll add
            ## *`sprintf`*
          </section>

          <section data-markdown>
            ## Properties + Interpolation

            &nbsp;
            &nbsp;

            <pre><code contenteditable>var properties_en = {
            &nbsp "msg_count" : "You have %d messages.",
            };
            &nbsp;
            sprintf( properties_en.msg_count, num_msgs );
            </code></pre>

            &nbsp;

            ## Look *familiar*?
          </section>
        </section>

        <section>
          <section data-markdown class="oneliner">
            ## So we can *switch out* messages
            ## and we can *interpolate* data into them.
          </section>
          <section data-markdown class="oneliner">
            ## But they're incorrectly *pluralized* and
            ## devoid of *gender* or *context*
            ## (and still more!)
          </section>
          <section data-markdown class="oneliner">
            ## Not to mention *authoring* templates
            ## with no messages in view
            ## starts to suck fast.
          </section>
        </section>

        <section data-markdown class="oneliner">
          # Back to *Stallman*
        </section>

        <section>
          <section data-markdown>
            # Gettext
            # &nbsp;

            ## *Plural Forms* and *PO Files*
          </section>

          <section data-markdown class="oneliner">
            ## Decouples data and message
          </section>

          <section data-markdown class="oneliner">
            ## Decouples data and message
            ## *and some locale specifics*
          </section>

          <section data-markdown>
            <h2 style="margin-top:-4%;">PO Files (as json, cause .po is uggers)</h2>

            <pre><code contenteditable>{
            &nbsp; "locale" : "en_US",
              "plural_form" : function (n) {
                if (n === 1) {
                  return 0;
                }
                return 1;
              },
              "messages" : {
                "There is 1 message." : [
                  "There is 1 message.",
                  "There are %d messages."
                ]
              }
            }</code></pre>
          </section>

          <section data-markdown>
            ## *Plural Form* Functions

            &nbsp;

            These are executed at runtime to see
            which of the strings to return.

            &nbsp;

            <pre><code contenteditable>var msg = ngettext(
              'There is 1 message',
              'There are %d messages.',
              msg_count
            );
            return sprintf(msg, msg_count);
            </code></pre>

            <aside class="notes">
              In this case, if the key didn't exist
            </aside>
          </section>

          <section data-markdown>
            ## The *English* Plural Form

&nbsp;

            <pre><code contenteditable>function (n) {
  if (n === 1) {
    return 0;
  }
  return 1;
}</code></pre>

            <aside class="notes">
              In order to make this more easily digestible,
              these are not the official functions.

              The real .po format has nulls and strings
              that define plural_forms. Not worth explaining.
            </aside>
          </section>

          <section data-markdown>
            ## The *Spanish* Plural Form

&nbsp;

            <pre><code contenteditable>function (n) {
  if (n === 1) {
    return 0;
  }
  return 1;
}</code></pre>
          </section>

          <section data-markdown>
            ## The *French* Plural Form

&nbsp;

            <pre><code contenteditable>function (n) {
  if (n == 1 || n == 0) {
    return 0;
  }
  return 1;
}</code></pre>
          </section>

          <section data-markdown>
            ## The *Slovenian* Plural Form

            <pre><code contenteditable>function (n) {
  if ((n % 100) == 1) {
    return 1;
  }
  if ((n % 100) == 2) {
    return 2;
  }
  if ((n % 100) == 3 || (n % 100) == 4) {
    return 3;
  }
  return 0;
}</code></pre>
          </section>

          <section data-markdown>
            ## Messages as Keys

            &nbsp;

            <pre><code contenteditable>My Template
            &lt;h1&gt;Jimmy's Message Notifier&lt;/h1&gt;

            &lt;p&gt;{{_ "There is 1 message." "There are %d messages." num_msgs}}&lt;/p&gt;
            </code></pre>

            <aside class="notes">
              In many language the underscore is the shortcut function to gettext
              <br />
              On the serverside, these are fuzzy matched, a little tougher in JS, but doable.
            </aside>
          </section>

          <section data-markdown class="oneliner">
            ## Gettext will *prefix* existing keys with
            ## your *context*. This can be used for
            ## differentiating *gender* messages.
          </section>

          <section data-markdown>
            <h2 style="margin-top:-6%;">Contexts for Gender</h2>

            <pre><code contenteditable>{
            &nbsp; "locale" : "en_US",
              "plural_form" : function (n) {
                if (n === 1) { return 1; }
                return 0;
              },
              "messages" : {
                "male*He has 1 message." : [
                  "He has 1 message.",
                  "He has %d messages."
                ],
                "female*He has 1 message." : [
                  "She has 1 message.",
                  "She has %d messages."
                ]
              }
            }</code></pre>

            <aside class="notes">
              It's actually a non-display unicode character that's used as the sentinel.
              <br />
              You could also do 'other' for unknown.
            </aside>
          </section>

          <section data-markdown>
            ## So, for gender...

            <pre style="margin-top:9%;" class="thin"><code contenteditable>pgettext("He liked it", gender);</code></pre>
            <aside class="notes">
              For some reason `p` means 'context' but we'll go with it.
            </aside>
          </section>

          <section data-markdown>
            ## Common Mistake

            <pre style="margin-top:8%;"><code>gettext("I like my red ") + gettext('shirt');</code></pre>
          </section>

          <section data-markdown class="oneliner">
            ## You *cannot ever* rely on being able to
            ## concatenate two translated strings into
            ## a *single message*.
          </section>

          <section data-markdown class="oneliner">
            ## I like my *red* shirt

            # vs.

            ## Me gusta mi camisa *roja*

            <aside class="notes">
              This is a contrived example, but it holds true in a lot
              of real world situations.
            </aside>
          </section>

        </section>

        <section>
          <section data-markdown class="oneliner">
            ## What do we have now?
          </section>

          <section data-markdown class="oneliner">
            ## We can *pluralize* our message.
          </section>

          <section data-markdown class="oneliner">
            ## We can *interpolate* our message.
          </section>

          <section data-markdown class="oneliner">
            ## We can *pluralize* our message
            ## correctly for each *locale*.
          </section>

          <section data-markdown class="oneliner">
            ## We can have templates with messages
            ## *kind of* in them. At least readably.
          </section>

          <section data-markdown class="oneliner">
            ## We can use gender specific words as the
            ## locale requires.

            <aside class="notes">
              Some languages don't really have gender-inspecific ways of saying things.
              <br />
              English barely does.
            </aside>
          </section>

          <section data-markdown class="oneliner">
            ## Gettext seems to do a good job at
            ## our *core concerns* across locales.
          </section>

          <section data-markdown class="oneliner">
            ## Interpolation
            ## Gender
            ## Pluralization
            ## Dev Happiness
          </section>

          <section data-markdown class="oneliner">
            # That's why I wrote *Jed*
          </section>
        </section>

        <section>
          <section data-markdown class="oneliner">
            <img src="img/jed.png" alt="Jed" style="margin-top:-3%;" />
          </section>

          <section data-markdown>
            <pre style="margin-top:-7%;"><code contenteditable>var i18n = new Jed({ locale_data: { ... } });
&nbsp;
// Use the chainable API
&nbsp;
i18n.translate( "There is one translation." )
    .onDomain( "messages" )
    .withContext( "male" )
    .ifPlural( num, "There are %d translations." )
    .fetch( num );
&nbsp;
// Or kick it old school
&nbsp;
var out = i18n.dnpgettext(
  "messages",
  "male",
  "There is one translation.",
  "There are %d translations.",
  num
);

Jed.sprintf( out, num );
            </code></pre>
          </section>


        </section>
      </div>
      <!--
          <pre class="thin"><code contenteditable>function Module () {
            return {
              someStuff: { ... }
            };
          }
          </code></pre>
      -->
      <!-- The navigational controls UI -->
      <aside class="controls">
        <a class="left" href="#">&#x25C4;</a>
        <a class="right" href="#">&#x25BA;</a>
        <a class="up" href="#">&#x25B2;</a>
        <a class="down" href="#">&#x25BC;</a>
      </aside>

      <!-- Displays presentation progress, max value changes via JS to reflect # of slides -->
      <div class="progress"><span></span></div>

    </div>

    <script src="js/reveal.js"></script>

    <!-- Optional libraries for code syntax highlighting and classList support in IE9 -->
    <script src="lib/highlight.js"></script>
    <script src="lib/classList.js"></script>

    <script>
      // Parse the query string into a key/value object
    var query = {};
    location.search.replace( /[A-Z0-9]+?=(\w*)/gi, function(a) {
        query[ a.split( '=' ).shift() ] = a.split( '=' ).pop();
        } );

    // Fires when a slide with data-state=customevent is activated
    Reveal.addEventListener( 'customevent', function() {
        alert( '"customevent" has fired' );
        } );

    // Fires each time a new slide is activated
    Reveal.addEventListener( 'slidechanged', function( event ) {
        // event.indexh & event.indexv
        } );

    Reveal.initialize({
        // Display controls in the bottom right corner
    controls: true,

    // Display a presentation progress bar
    progress: true,

    // If true; each slide will be pushed to the browser history
    history: true,

    // Loops the presentation, defaults to false
    loop: false,

    // Flags if mouse wheel navigation should be enabled
    mouseWheel: true,

    // Apply a 3D roll to links on hover
    rollingLinks: true,

    // UI style
    theme: query.theme || 'default', // default/neon

    // Transition style
    transition: query.transition || 'default' // default/cube/page/concave/linear(2d)
    });

    hljs.initHighlightingOnLoad();

    (function boom(){

     if (!window.Showdown){
     var scr = document.createElement('script');
     scr.onload = boom;
     scr.src = 'js/showdown.js';
     document.body.appendChild(scr);
     return;
     }

     [].forEach.call( document.querySelectorAll('[data-markdown]'), function  fn(elem){

       // strip leading whitespace so it isn't evaluated as code
       var text      = elem.innerHTML.replace(/\n\s*\n/g,'\n'),
       // set indentation level so your markdown can be indented within your HTML
       leadingws = text.match(/^\n?(\s*)/)[1].length,
       regex     = new RegExp('\\n?\\s{' + leadingws + '}','g'),
       md        = text.replace(regex,'\n'),
       html      = (new Showdown.converter()).makeHtml(md);

       // here, have sum HTML
       elem.innerHTML = html;

       });

     }());
   </script>

    <!-- the next two lines enable the speaker notes server -->
    <script src="socket.io/socket.io.js"></script>
    <script>
(function() {
  // don't emit events from inside the previews themselves
  var qs = window.location.href.split('?');
  if (qs.length > 1 && qs[1].match('receiver')) { return; }

  var socket = io.connect(window.location.origin);
  var socketId = Math.random().toString().slice(2);
  console.log('View slide notes at ' + window.location.origin + '/_notes/' + socketId);

  Reveal.addEventListener( 'slidechanged', function( event ) {
    var nextindexh;
    var nextindexv;
    var slideElement = event.currentSlide;

    console.log(event);
    if (slideElement.nextElementSibling && slideElement.parentNode.nodeName == 'SECTION') {
      nextindexh = event.indexh;
      nextindexv = event.indexv + 1;
    } else {
      nextindexh = event.indexh + 1;
      nextindexv = 0;
    }

    var notes = slideElement.querySelector('aside.notes');
    var slideData = {
      notes : notes ? notes.innerHTML : '',
      indexh : event.indexh,
      indexv : event.indexv,
      nextindexh : nextindexh,
      nextindexv : nextindexv,
      socketId : socketId
    };

    socket.emit('slidechanged', slideData);
  } );
}());
    </script>

  </body>
</html>
